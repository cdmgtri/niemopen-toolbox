import{_ as K}from"./Bg24vwOX.js";import{_ as Z,b as Q}from"./Dbequ_sm.js";import{A as b,T as p,a as Y,_ as ee,b as oe,c as le}from"./DlY8Zih8.js";import{_ as ne,a as te,b as ae}from"./PT20ulrQ.js";import{e as se,J as w,q as F,S as ie,T as re,U as me,o as S,c as U,b as t,w as a,f as l,M as ue,a as i,d as r,V as fe,W as q,K as pe}from"./CWQT1cTJ.js";import{_ as de}from"./CvNyCD49.js";import{A as $}from"./D_BTO39A.js";import{_ as s}from"./CEzrgrCa.js";import"./B5UyGN4k.js";import"./n33wfxEN.js";import"./6bm_RRcn.js";import"./FvzNdf1L.js";import"./Cpj98o6Y.js";import"./C0e8eNHv.js";const ce={key:0},ve={key:1},Ae=se({__name:"transform",setup(be){const m=w("upload"),g=[{value:"upload",label:"Upload",icon:s.upload},{type:"separator"},{label:"Valid examples",type:"label"},{value:"cmf",label:"CMF",icon:s.cmf,from:"cmf",path:"demo/transform/CrashDriver-5.0.cmf.xml"},{value:"xsd",label:"XSD",icon:s.xml,from:"xsd",path:"demo/transform/CrashDriver-5.0.zip"},{type:"separator"},{label:"Invalid examples",type:"label"},{value:"cmf-invalid",label:"CMF 0.6",icon:s.error,from:"cmf",path:"demo/transform/CrashDriver-5.0-CMFv0.6.cmf.xml"},{value:"text",label:".txt file",icon:s.error,from:void 0,path:"demo/transform/CrashDriver-5.0.txt"}],I=F(()=>g.find(o=>o.value==m.value)),_=w();ie(m,async(o,e)=>{var u,v;I.value&&m.value!="upload"?(n.file=await p.loadPublicFile(I.value.path),_.value=(u=n.file)==null?void 0:u.name,n.from=(v=I.value)==null?void 0:v.from):(n.file=void 0,n.from=void 0),M.value.clear(),c.request="unsent"});const n=re({}),x=[{value:"cmf",label:"CMF XML",icon:s.cmf,extensions:["cmf","xml"]},{value:"xsd",label:"NIEM XSD",icon:s.xml,extensions:["zip","xsd"]}],A=[...x,{value:"json_schema",label:"JSON Schema",icon:s.json,extensions:["schema.json","jschema","json"]},{value:"owl",label:"OWL",icon:s.owl,extensions:["ttl"]}],D=F(()=>x.find(o=>o.value==n.from)),E=F(()=>A.find(o=>o.value===n.to)),R=F(()=>{var o;return Y.extension((o=n.file)==null?void 0:o.name)}),P=x.flatMap(o=>o.extensions),N=P.map(o=>"."+o).join(", ");async function X(o){C.value="",n.file=p.fileInput(o),n.from=h(),c.request="unsent",await M.value.validate({name:"",silent:!0})}function h(){switch(R.value){case"cmf":case"xml":case"cmf.xml":return"cmf";case"xsd":case"zip":return"xsd";default:return}}const j=F(()=>{var o;return`curl -i -X POST -H "Content-Type: multipart/form-data" -F from=${n.from} -F to=${n.to} -F file=@${(o=n.file)==null?void 0:o.name} ${b.routes.transform}`}),M=me("form"),C=w();let V=!1;function z(o){const e=p.initFormErrors();return C.value=void 0,V&&(p.validateRequiredField(e,"from",o.from),p.validateRequiredField(e,"to",o.to),p.validateRequiredField(e,"file",o.file),p.validateFileExtension(e,"file",P,R.value)),e}const c=b.initResults();async function B(){var u;if(V=!0,await((u=M.value)==null?void 0:u.validate({name:"",silent:!0}))==!1){V=!1;return}const e=await b.post(b.routes.transform,n,c);await b.downloadFileResults(e,c),V=!1}return(o,e)=>{const u=K,v=Q,L=oe,O=Z,k=ne,y=te,T=ae,W=pe,G=le,H=de,J=ee;return S(),U(ue,null,[t(O,{page:("AppItems"in o?o.AppItems:l($)).transform},{user:a(()=>[e[11]||(e[11]=i("p",null," Transform a NIEM subset, schema, IEPD schemas, or message model in either CMF or NIEM XML Schema to another supported format. ",-1)),i("p",null,[e[6]||(e[6]=r(" This functionality leverages the ")),t(u,{link:("AppItems"in o?o.AppItems:l($)).cmfToolRepo},null,8,["link"]),e[7]||(e[7]=r()),t(v,null,{default:a(()=>e[4]||(e[4]=[r("version 0.7-alpha.6")])),_:1}),e[8]||(e[8]=r(" which supports ")),t(u,{link:("AppItems"in o?o.AppItems:l($)).cmfRepo},null,8,["link"]),e[9]||(e[9]=r()),t(v,null,{default:a(()=>e[5]||(e[5]=[r("version 0.8")])),_:1}),e[10]||(e[10]=r(". "))]),e[12]||(e[12]=i("p",{class:"font-medium"},"Tips:",-1)),e[13]||(e[13]=i("ul",{class:"bullets"},[i("li",null," CMF inputs have to be the version supported by this tool. "),i("li",null," CMF version migration is not automated and must be done by hand. "),i("li",null," NIEM XSD inputs can be a single schema as a XSD file or multiple schemas in a zip file. "),i("li",null," Validation or conformance errors may lead to transform failure. ")],-1)),e[14]||(e[14]=i("br",null,null,-1))]),developer:a(()=>[t(L,{title:"POST request",code:l(j)},null,8,["code"])]),_:1},8,["page"]),t(H,null,{default:a(()=>[t(G,{ref_key:"form",ref:M,state:l(n),validate:z,"validate-on":["change"],onSubmit:fe(B,["prevent"]),enctype:"multipart/form-data"},{default:a(()=>[t(T,{name:"file",required:"",error:l(C),label:"1. Select a model input file",help:("ToolboxForm"in o?o.ToolboxForm:l(p)).fileWarning(l(m)=="upload")},{default:a(()=>{var f;return[l(m)=="upload"?(S(),U("span",ce,[t(k,{type:"file",onChange:X,accept:l(N),icon:("icons"in o?o.icons:l(s)).upload,ui:o.UI.inputFileInGroup},{trailing:a(()=>e[15]||(e[15]=[r("(CMF | XSD | ZIP)")])),_:1},8,["accept","icon","ui"])])):(S(),U("span",ve,[t(k,{modelValue:l(_),"onUpdate:modelValue":e[0]||(e[0]=d=>q(_)?_.value=d:null),ui:o.UI.inputFileInGroup,icon:("icons"in o?o.icons:l(s)).magic},null,8,["modelValue","ui","icon"])])),t(y,{modelValue:l(m),"onUpdate:modelValue":e[1]||(e[1]=d=>q(m)?m.value=d:null),items:g,color:"neutral",variant:"subtle",ui:o.UI.inputMode,icon:(f=l(I))==null?void 0:f.icon},null,8,["modelValue","ui","icon"])]}),_:1},8,["error","help"]),t(T,{name:"from",required:"",label:"2. Select input file format"},{default:a(()=>{var f;return[t(y,{modelValue:l(n).from,"onUpdate:modelValue":e[2]||(e[2]=d=>l(n).from=d),items:x,icon:(f=l(D))==null?void 0:f.icon,class:"w-64"},null,8,["modelValue","icon"])]}),_:1}),t(T,{name:"to",required:"",label:"3. Select transformation format"},{default:a(()=>{var f;return[t(y,{modelValue:l(n).to,"onUpdate:modelValue":e[3]||(e[3]=d=>l(n).to=d),items:A,icon:(f=l(E))==null?void 0:f.icon,class:"w-64"},null,8,["modelValue","icon"])]}),_:1}),t(W,{type:"submit"},{default:a(()=>e[16]||(e[16]=[r("Transform")])),_:1})]),_:1},8,["state"])]),_:1}),t(J,{results:l(c)},null,8,["results"])],64)}}});export{Ae as default};
