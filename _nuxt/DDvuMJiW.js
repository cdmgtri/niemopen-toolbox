import{i as W,j as x,l as h,o as c,c as b,b as r,w as n,a as s,d as f,F as E,r as U,t as g,q as R,e as l,m as Z,f as q,h as z,n as J}from"./9gN2iNQf.js";import{h as A,_ as K,a as Q,d as Y,c as ee,b as ae,e as te,f as le,g as ie,F as oe}from"./CEUGHRsr.js";import{_ as ne,a as se}from"./C7Xobx0F.js";import{b as N,i as _,l as re}from"./DEqQpGQK.js";import{_ as me}from"./DlAUqK2U.js";import"./BxVfXhKE.js";import"./Cpj98o6Y.js";const de={class:"bullets spaced-sm"},ce={class:"font-semibold mb-3"},fe={class:"bullets spaced-sm"},pe={class:"font-semibold"},ue={key:0,class:"font-light"},ge=W({__name:"validate",setup(_e){const t=x({returned:!1,category:"pending",title:"",message:"",filename:"",time:""}),i=x({kindValue:void 0,file1:void 0,file2:void 0,resultFormat:"csv"}),T=[{label:"XML schemas",type:"label",group:"display"},{value:"ndr",label:"Validate NDR conformance",type:"item",description:"Check one or more NIEM XML schemas against the NIEM Naming and Design Rules (NDR)",group:"XSD",route:N.validate_ndr,file1:{fileType:"XSD | ZIP",icon:_.xml,description:"NIEM XSD",paramName:"file",file:void 0}},{value:"xsd",label:"Validate NIEM XSD",type:"item",description:"Validate one or more XML schemas to check that the basic syntax is correct.",group:"XSD",route:N.validate_xsd,file1:{fileType:"XSD | ZIP",icon:_.xml,description:"NIEM XSD",paramName:"file",file:void 0}},{type:"separator",group:"display"},{label:"XML instances",type:"label",group:"display"},{value:"cmf",label:"Validate CMF",type:"item",description:"Validate a CMF file (an XML instance file) against its NIEM CMF XML schema.",note:"Note that this does not check NDR conformance of the content.",group:"XML",route:N.validate_cmf,file1:{fileType:"CMF | XML",icon:_.xml,description:"CMF",paramName:"file",file:void 0}},{value:"xml",label:"Validate XML",type:"item",description:"Validate one or more XML instances against its user-provided XML schemas.",group:"XML",route:N.validate_xml,file1:{fileType:"CMF | XML",icon:_.xml,description:"XML instance",paramName:"xml",file:void 0},file2:{fileType:"ZIP",icon:_.zip,description:"NIEM XSD",paramName:"xsd",file:void 0}},{value:"message-catalog",label:"Validate message catalog",type:"item",description:"Validate an IEPD or message catalog (an XML instance file) against its NIEM IEPD / message catalog schema.",group:"XML",route:N.validate_message_catalog,file1:{fileType:"XML",icon:_.xml,description:"message-catalog.xml or iepd-catalog.xml",paramName:"file",file:void 0}},{value:"xml-catalog",label:"Validate XML catalog",type:"item",description:"Validate an XML catalog (an XML instance file) against the OASIS schema specification for XML catalogs.",group:"XML",route:N.validate_xml_catalog,file1:{fileType:"XML",icon:_.xml,description:"xml-catalog.xml",paramName:"file",file:void 0}}],$=x(T.filter(a=>a.type=="item")),O=x({XSD:$.filter(a=>a.group=="XSD"),XML:$.filter(a=>a.group=="XML")}),o=h(()=>$.find(a=>a.value==i.kindValue));function B(a){return`${a||"(pending)"} | ${A}`}const j=h(()=>{var a,e;return i.file2?`-F ${(e=(a=o.value)==null?void 0:a.file2)==null?void 0:e.paramName}=@${i.file2.name}`:""}),G=h(()=>{var a,e,m,d,v;return`curl -i -X POST -H "Content-Type: multipart/form-data" -F ${(e=(a=o.value)==null?void 0:a.file1)==null?void 0:e.paramName}=${(m=i.file1)==null?void 0:m.name} ${j.value} -F file=@${(d=i.file1)==null?void 0:d.name} ${(v=o.value)==null?void 0:v.route}`});async function H(a){var y,X,I,S;if(!i.kindValue||!((y=o.value)!=null&&y.route)||!a.target){console.log("cancelling request for missing fields");return}const m=a.target.files;if(!m||m.length==0){console.log("cancelling request for missing files");return}i.file1=m[0],i.file2=m[1];const d=new FormData;o.value.value=="xml"?(d.append("xml",i.file1),d.append("xsd",i.file2)):d.append("file",i.file1),console.log("Sending validation request",i.kindValue,i.file1,i.file2);let v=Date.now();const M=await fetch(o.value.route,{body:d,method:"post"});if(t.time=ie(v),M.ok){const C=await M.blob(),L=M.headers.get("Content-Disposition");t.filename=(L==null?void 0:L.split("=")[1])||"migration-results.zip",oe.saveAs(C,t.filename),t.category="success",t.error=void 0,t.title="",t.message=`Downloaded ${t.filename}`,console.log("Request succeeded",t.filename)}else t.category="error",t.error=await M.json(),t.title=`ERROR ${(X=t.error)==null?void 0:X.status}: ${(I=t.error)==null?void 0:I.error}`,t.message=((S=t.error)==null?void 0:S.message.replaceAll(";",`

`))||"",console.log("Request failed");t.returned=!0}return(a,e)=>{const m=z,d=Q,v=ne,M=Y,y=ee,X=ae,I=J,S=te,C=se,L=le;return c(),b(E,null,[r(v,{link:("links"in a?a.links:l(re)).validate},{info:n(()=>[e[8]||(e[8]=s("p",null," Validate NIEM artifacts and check NDR conformance. ",-1)),e[9]||(e[9]=s("p",{class:"font-semibold"},"Notes:",-1)),s("ul",de,[s("li",null,[e[2]||(e[2]=f(" Use the ")),r(m,{to:"/transform"},{default:n(()=>e[1]||(e[1]=[f("Transform")])),_:1}),e[3]||(e[3]=f(" feature to convert a CMF model to XSD to check NDR conformance. "))]),e[4]||(e[4]=s("li",null," JSON instance and schema validation is not yet available. ",-1))]),(c(!0),b(E,null,U(Object.entries(l(O)),([F,k])=>(c(),b("div",null,[s("p",ce,g(F)+" validation options:",1),s("ul",fe,[(c(!0),b(E,null,U(k,p=>(c(),b("li",null,[s("span",pe,g(p.label),1),e[6]||(e[6]=f(" - ")),s("span",null,g(p.description),1),p.note?(c(),b("span",ue,[e[5]||(e[5]=s("br",null,null,-1)),f(g(p.note),1)])):R("",!0)]))),256))]),e[7]||(e[7]=s("br",null,null,-1))]))),256))]),developer:n(()=>[r(d,{title:"POST request",code:l(G)},null,8,["code"])]),_:1},8,["link"]),r(C,null,{default:n(()=>[r(S,{state:l(i),onSubmit:Z(H,["prevent"]),enctype:"multipart/form-data"},{default:n(()=>{var F,k,p,P;return[r(y,{name:"kind",required:"",label:"1. Select validation kind"},{default:n(()=>[r(M,{modelValue:l(i).kindValue,"onUpdate:modelValue":e[0]||(e[0]=u=>l(i).kindValue=u),items:T,class:"w-64"},null,8,["modelValue"])]),_:1}),r(y,{name:"file1",required:"",label:"2. Select a file to validate",help:B((k=(F=l(o))==null?void 0:F.file1)==null?void 0:k.description)},{default:n(()=>{var u,D;return[r(X,{class:"w-[600px]",icon:(D=(u=l(o))==null?void 0:u.file1)==null?void 0:D.icon},{trailing:n(()=>{var V,w;return[f("("+g((w=(V=l(o))==null?void 0:V.file1)==null?void 0:w.fileType)+")",1)]}),_:1},8,["icon"])]}),_:1},8,["help"]),(p=l(o))!=null&&p.file2?(c(),q(y,{key:0,name:"file2",label:"3. Select supporting file for validation",help:((P=l(o))==null?void 0:P.file2.description)+" | "+("FILE_UPLOAD_WARNING"in a?a.FILE_UPLOAD_WARNING:l(A))},{default:n(()=>{var u,D;return[r(X,{class:"w-[600px]",icon:(D=(u=l(o))==null?void 0:u.file2)==null?void 0:D.icon},{trailing:n(()=>{var V;return[f("("+g((V=l(o).file2)==null?void 0:V.fileType)+")",1)]}),_:1},8,["icon"])]}),_:1},8,["help"])):R("",!0),r(I,{type:"submit",ui:("ui"in a?a.ui:l(K)).button_default},{default:n(()=>e[10]||(e[10]=[f("Validate")])),_:1},8,["ui"])]}),_:1},8,["state"])]),_:1}),l(t).returned?(c(),q(L,{key:0,category:l(t).category,title:l(t).title,seconds:l(t).time},{default:n(()=>[s("div",null,g(l(t).message),1)]),_:1},8,["category","title","seconds"])):R("",!0)],64)}}}),De=me(ge,[["__scopeId","data-v-8b3b265a"]]);export{De as default};
