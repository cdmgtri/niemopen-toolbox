import{e as Ee,J as N,q as b,S as Ie,T as w,U as Ve,o as x,c as I,b as s,w as p,f as i,M as P,a as c,d as V,O as K,t as F,z as Q,V as _e,W as A,s as W,R as Me,K as he}from"./CWQT1cTJ.js";import{A as f,T as m,a as Y,_ as Fe,b as Ne,c as Te}from"./DlY8Zih8.js";import{_ as Xe}from"./Dbequ_sm.js";import{a as Se,b as Le,_ as De}from"./PT20ulrQ.js";import{_ as ke}from"./CvNyCD49.js";import{A as Ce}from"./D_BTO39A.js";import{_ as o}from"./CEzrgrCa.js";import"./B5UyGN4k.js";import"./n33wfxEN.js";import"./6bm_RRcn.js";import"./FvzNdf1L.js";import"./Cpj98o6Y.js";import"./C0e8eNHv.js";const Z=[{label:"XML schemas",type:"label",group:"display"},{value:"ndr",label:"Validate NDR conformance",type:"item",description:"Check one or more NIEM XML schemas against the NIEM Naming and Design Rules (NDR)",extensions:["xsd","zip"],icon:o.book,group:"XSD",route:f.routes.validate_ndr,file1:{icon:o.xml,description:"NIEM XSD",paramName:"file",validExtensions:[".xsd",".zip"],pathValidExample:"demo/validate/ndr/CrashDriver-6.0.zip",pathInvalidExample:"demo/validate/ndr/Crash Driver IEPD 5.0 invalid.zip"}},{value:"xsd",label:"Validate XSD",type:"item",description:"Validate one or more XML schemas to check that the basic syntax is correct.",extensions:["xsd","zip"],icon:o.xml,group:"XSD",route:f.routes.validate_xsd,file1:{icon:o.xml,description:"XSD",paramName:"file",validExtensions:[".xsd",".zip"],pathValidExample:"demo/validate/xml/single/person.xsd",pathInvalidExample:"demo/validate/xml/single/person-invalid.xsd"}},{type:"separator",group:"display"},{label:"XML instances",type:"label",group:"display"},{value:"cmf",label:"Validate CMF",type:"item",description:"Validate a CMF file (an XML instance file) against its NIEM CMF XML schema.",note:"Note that this does not check NDR conformance of the content.",extensions:["xml","cmf"],icon:o.xml,group:"XML",route:f.routes.validate_cmf,file1:{icon:o.xml,description:"CMF",paramName:"file",validExtensions:[".cmf",".xml"],pathValidExample:"demo/validate/xml/cmf/CrashDriver-5.0.cmf.xml",pathInvalidExample:"demo/validate/xml/cmf/CrashDriver-5.0-invalid.cmf.xml"}},{value:"xml",label:"Validate XML",type:"item",description:"Validate one or more XML instances against its user-provided XML schemas.",extensions:["xml"],icon:o.xml,group:"XML",route:f.routes.validate_xml,file1:{icon:o.xml,description:"XML instance",paramName:"xml",validExtensions:[".xml"],pathValidExample:"demo/validate/xml/single/person.xml",pathInvalidExample:"demo/validate/xml/single/person-invalid.xml"},file2:{icon:o.zip,description:"NIEM XSD",paramName:"xsd",validExtensions:[".xsd",".zip"],pathValidExample:"demo/validate/xml/single/person.xsd",pathInvalidExample:"demo/validate/xml/single/person.xsd"}},{value:"message-catalog",label:"Validate message catalog",type:"item",description:"Validate an IEPD or message catalog (an XML instance file) against its NIEM IEPD / message catalog schema.",extensions:["xml"],icon:o.xml,group:"XML",route:f.routes.validate_message_catalog,file1:{icon:o.xml,description:"message-catalog.xml or iepd-catalog.xml",paramName:"file",validExtensions:[".xml"],pathValidExample:"demo/validate/xml/message-catalog/valid-5.0/iepd-catalog.xml",pathInvalidExample:"demo/validate/xml/message-catalog/invalid-5.0/iepd-catalog.xml"}},{value:"xml-catalog",label:"Validate XML catalog",type:"item",description:"Validate an XML catalog (an XML instance file) against the OASIS schema specification for XML catalogs.",extensions:["xml"],icon:o.xml,group:"XML",route:f.routes.validate_xml_catalog,file1:{icon:o.xml,description:"xml-catalog.xml",paramName:"file",validExtensions:[".xml"],pathValidExample:"demo/validate/xml/xml-catalog/xml-catalog-valid.xml",pathInvalidExample:"demo/validate/xml/xml-catalog/xml-catalog-invalid.xml"}}],$e={class:"bullets spaced-sm"},Ue={class:"font-semibold mb-3"},Re={class:"bullets spaced-sm"},we={class:"font-semibold"},Pe={key:0,class:"font-light"},Ae={key:0},qe={key:1},ze={key:1},ia=Ee({__name:"validate",setup(Oe){const v=N("upload"),q=[{value:"upload",icon:o.upload,label:"Upload"},{type:"separator"},{type:"label",label:"Demo files"},{value:"valid",icon:o.success,label:"Valid"},{value:"invalid",icon:o.error,label:"Invalid"}],ee=b(()=>q.find(e=>e.value==v.value));Ie(v,async(e,a)=>{await z()});const T=N(),X=N();async function ae(){await z()}function le(e){fe.value="",t.file1=m.fileInput(e),_.request="unsent"}function ie(e){ve.value="",t.file2=m.fileInput(e),_.request="unsent"}async function z(){var e,a,n,d,E,u,r,g,S,L;_.request="unsent",v.value=="valid"?(t.file1=await m.loadPublicFile((a=(e=l.value)==null?void 0:e.file1)==null?void 0:a.pathValidExample),(n=l.value)!=null&&n.file2&&(t.file2=await m.loadPublicFile((d=l.value)==null?void 0:d.file2.pathValidExample))):v.value=="invalid"&&(t.file1=await m.loadPublicFile((u=(E=l.value)==null?void 0:E.file1)==null?void 0:u.pathInvalidExample),(r=l.value)!=null&&r.file2&&(t.file2=await m.loadPublicFile((g=l.value)==null?void 0:g.file2.pathInvalidExample))),v.value!="upload"&&(T.value=(S=t.file1)==null?void 0:S.name,X.value=(L=t.file2)==null?void 0:L.name)}const t=w({mediaType:"json"}),$=w(Z.filter(e=>e.type=="item")),te=w({XSD:$.filter(e=>e.group=="XSD"),XML:$.filter(e=>e.group=="XML")}),l=b(()=>$.find(e=>e.value==t.kind)),ne=b(()=>{var e;return O((e=l.value)==null?void 0:e.file1)}),oe=b(()=>{var e;return O((e=l.value)==null?void 0:e.file2)});function O(e){return e?`(${e.validExtensions.join(" | ").replaceAll(".","").toUpperCase()})`:""}const se=f.reportMediaTypes,de=b(()=>f.mediaTypeIcon(t.mediaType)),me=b(()=>f.mediaTypeQueryString(t.mediaType));function G(e){return v.value=="upload"?`${m.UPLOAD_WARNING} | ${e||"(pending)"}`:m.DEMO_FILE_MESSAGE}const re=b(()=>{var e,a,n;return Y.extension((n=(a=(e=l.value)==null?void 0:e.file1)==null?void 0:a.file)==null?void 0:n.name)}),ue=b(()=>{var e,a,n;return Y.extension((n=(a=(e=l.value)==null?void 0:e.file2)==null?void 0:a.file)==null?void 0:n.name)}),pe=b(()=>{var e,a,n,d;return((e=l.value)==null?void 0:e.file2)!=null?`-F ${(n=(a=l.value)==null?void 0:a.file2)==null?void 0:n.paramName}=@${(d=t.file2)==null?void 0:d.name}`:""}),ce=b(()=>{var e,a,n,d;return`curl -i -X POST -H "Content-Type: multipart/form-data" -F ${(a=(e=l.value)==null?void 0:e.file1)==null?void 0:a.paramName}=@${(n=t.file1)==null?void 0:n.name} ${pe.value} ${(d=l.value)==null?void 0:d.route}${me.value}`}),B=Ve("form"),fe=N(""),ve=N("");let U=!1;function xe(e){var n,d,E,u,r;const a=m.initFormErrors();return m.validateRequiredField(a,"kind",e.kind),m.validateRequiredField(a,"resultFormat",e.mediaType),U&&(m.validateRequiredField(a,"file1",e.file1),m.validateFileExtension(a,"file1",((d=(n=l.value)==null?void 0:n.file1)==null?void 0:d.validExtensions)||[],re.value),(E=l.value)!=null&&E.file2&&(m.validateRequiredField(a,"file2",e.file2),m.validateFileExtension(a,"file2",((r=(u=l.value)==null?void 0:u.file2)==null?void 0:r.validExtensions)||[],ue.value))),a}const _=f.initResults();async function ge(){var u,r,g;if(U=!0,await((u=B.value)==null?void 0:u.validate())==!1||!((r=l.value)!=null&&r.file1)||!l.value.route||!t.file1)return;let a={};a[(g=l.value.file1)==null?void 0:g.paramName]=t.file1,l.value.file2&&(a[l.value.file2.paramName]=t.file2),a.mediaType=t.mediaType;let n=t.file1.name.split(".").slice(0,-1).join(".").replaceAll(" ","-"),d=l.value.value=="message-catalog"||l.value.value=="xml-catalog"?"":l.value.value+"-";_.filename=`${n}-${d}validation-report.${t.mediaType}`;const E=await f.post(l.value.route,a,_,!1);await f.downloadReportResults(t.mediaType,E,_),U=!1}return(e,a)=>{const n=Me,d=Ne,E=Xe,u=Se,r=Le,g=De,S=he,L=Te,ye=ke,be=Fe;return x(),I(P,null,[s(E,{page:("AppItems"in e?e.AppItems:i(Ce)).validate},{user:p(()=>[a[13]||(a[13]=c("p",null," Validate NIEM artifacts and check NDR conformance. ",-1)),a[14]||(a[14]=c("p",{class:"font-semibold"},"Notes:",-1)),c("ul",$e,[c("li",null,[a[6]||(a[6]=V(" Use the ")),s(n,{to:"/transform"},{default:p(()=>a[5]||(a[5]=[V("Transform")])),_:1}),a[7]||(a[7]=V(" feature to convert a CMF model to XSD to check NDR conformance. "))]),a[8]||(a[8]=c("li",null," JSON instance and schema validation is not yet available. ",-1)),a[9]||(a[9]=c("li",null," CSV results are download-only at this time and cannot be displayed. ",-1))]),(x(!0),I(P,null,K(Object.entries(i(te)),([D,k])=>(x(),I("div",null,[c("p",Ue,F(D)+" validation options:",1),c("ul",Re,[(x(!0),I(P,null,K(k,M=>(x(),I("li",null,[c("span",we,F(M.label),1),a[11]||(a[11]=V(" - ")),c("span",null,F(M.description),1),M.note?(x(),I("span",Pe,[a[10]||(a[10]=c("br",null,null,-1)),V(F(M.note),1)])):Q("",!0)]))),256))]),a[12]||(a[12]=c("br",null,null,-1))]))),256))]),developer:p(()=>[s(d,{title:"POST request",code:i(ce)},null,8,["code"])]),_:1},8,["page"]),s(ye,null,{default:p(()=>[s(L,{ref_key:"form",ref:B,state:i(t),validate:xe,onSubmit:_e(ge,["prevent"]),enctype:"multipart/form-data"},{default:p(()=>{var D,k,M,j;return[s(r,{name:"kind",required:"",label:"1. Select validation kind",help:(D=i(l))==null?void 0:D.description},{default:p(()=>{var y;return[s(u,{modelValue:i(t).kind,"onUpdate:modelValue":a[0]||(a[0]=h=>i(t).kind=h),items:i(Z),onChange:ae,icon:(y=i(l))==null?void 0:y.icon,class:"w-64"},null,8,["modelValue","items","icon"])]}),_:1},8,["help"]),s(r,{name:"mediaType",required:"",label:"2. Select results format"},{default:p(()=>[s(u,{modelValue:i(t).mediaType,"onUpdate:modelValue":a[1]||(a[1]=y=>i(t).mediaType=y),items:i(se),icon:i(de),class:"w-64"},null,8,["modelValue","items","icon"])]),_:1}),s(r,{name:"file1",required:"",label:"3. Select a file to validate",help:G((M=(k=i(l))==null?void 0:k.file1)==null?void 0:M.description)},{default:p(()=>{var y,h,C,H,J;return[i(v)=="upload"?(x(),I("span",Ae,[s(g,{type:"file",onChange:le,accept:(h=(y=i(l))==null?void 0:y.file1)==null?void 0:h.validExtensions,icon:((H=(C=i(l))==null?void 0:C.file1)==null?void 0:H.icon)||("icons"in e?e.icons:i(o)).upload,ui:e.UI.inputFileInGroup},{trailing:p(()=>[V(F(i(ne)),1)]),_:1},8,["accept","icon","ui"])])):(x(),I("span",qe,[s(g,{modelValue:i(T),"onUpdate:modelValue":a[2]||(a[2]=R=>A(T)?T.value=R:null),ui:e.UI.inputFileInGroup,icon:("icons"in e?e.icons:i(o)).magic},null,8,["modelValue","ui","icon"])])),s(u,{modelValue:i(v),"onUpdate:modelValue":a[3]||(a[3]=R=>A(v)?v.value=R:null),items:q,color:"neutral",variant:"subtle",ui:e.UI.inputMode,icon:(J=i(ee))==null?void 0:J.icon},null,8,["modelValue","ui","icon"])]}),_:1},8,["help"]),(j=i(l))!=null&&j.file2?(x(),W(r,{key:0,name:"file2",label:"4. Select supporting file for validation",help:G(i(l).file2.description)},{default:p(()=>{var y,h;return[i(v)=="upload"?(x(),W(g,{key:0,type:"file",onChange:ie,accept:i(l).file2.validExtensions,icon:((h=(y=i(l))==null?void 0:y.file2)==null?void 0:h.icon)||("icons"in e?e.icons:i(o)).upload,ui:e.UI.inputFileInGroup},{trailing:p(()=>[V(F(i(oe)),1)]),_:1},8,["accept","icon","ui"])):(x(),I("span",ze,[s(g,{modelValue:i(X),"onUpdate:modelValue":a[4]||(a[4]=C=>A(X)?X.value=C:null),ui:e.UI.inputFileInGroup,icon:("icons"in e?e.icons:i(o)).magic},null,8,["modelValue","ui","icon"])]))]}),_:1},8,["help"])):Q("",!0),s(S,{type:"submit"},{default:p(()=>a[15]||(a[15]=[V("Validate")])),_:1})]}),_:1},8,["state"])]),_:1}),s(be,{results:i(_),kind:i(t).kind},null,8,["results","kind"])],64)}}});export{ia as default};
