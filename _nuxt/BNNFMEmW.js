import{i as ue,j as I,l as T,k as A,o as N,c as S,b as s,w as m,a as u,d as x,F as h,r as B,t as X,p as z,e as n,m as fe,f as pe,h as ge,n as ve}from"./qZ1Z2gf-.js";import{j as G,_ as _e,v as $,a as xe,d as ye,c as be,b as De,e as Ne,f as Me,i as Se,h as Xe,F as we}from"./3MUQeXho.js";import{_ as Ie,c as Te,a as Ce}from"./Cv0iLtbJ.js";import{_ as Fe}from"./Dn2P6ws4.js";import{i as r,b as C,l as Le}from"./cgod6wvZ.js";import{_ as $e}from"./DlAUqK2U.js";import"./DH2XsfIj.js";import"./CnS8ArCL.js";import"./6bm_RRcn.js";import"./Cpj98o6Y.js";const ke={class:"bullets spaced-sm"},Ve={class:"font-semibold mb-3"},he={class:"bullets spaced-sm"},Ee={class:"font-semibold"},Re={key:0,class:"font-light"},je=ue({__name:"validate",setup(Pe){const t=I({status:"unsent",category:"pending",title:"",message:"",filename:"",time:""}),i=I({kind:void 0,file1:void 0,file2:void 0,mediaType:"json"}),E=[{label:"XML schemas",type:"label",group:"display"},{value:"ndr",label:"Validate NDR conformance",type:"item",description:"Check one or more NIEM XML schemas against the NIEM Naming and Design Rules (NDR)",extensions:["xsd","zip"],icon:r.book,group:"XSD",route:C.validate_ndr,file1:{fileType:"XSD | ZIP",icon:r.xml,description:"NIEM XSD",paramName:"file",file:void 0}},{value:"xsd",label:"Validate NIEM XSD",type:"item",description:"Validate one or more XML schemas to check that the basic syntax is correct.",extensions:["xsd","zip"],icon:r.xml,group:"XSD",route:C.validate_xsd,file1:{fileType:"XSD | ZIP",icon:r.xml,description:"NIEM XSD",paramName:"file",file:void 0}},{type:"separator",group:"display"},{label:"XML instances",type:"label",group:"display"},{value:"xml",label:"Validate XML",type:"item",description:"Validate one or more XML instances against its user-provided XML schemas.",extensions:["xml"],icon:r.xml,group:"XML",route:C.validate_xml,file1:{fileType:"CMF | XML",icon:r.xml,description:"XML instance",paramName:"xml",file:void 0},file2:{fileType:"ZIP",icon:r.zip,description:"NIEM XSD",paramName:"xsd",file:void 0}},{value:"message-catalog",label:"Validate message catalog",type:"item",description:"Validate an IEPD or message catalog (an XML instance file) against its NIEM IEPD / message catalog schema.",extensions:["xml"],icon:r.xml,group:"XML",route:C.validate_message_catalog,file1:{fileType:"XML",icon:r.xml,description:"message-catalog.xml or iepd-catalog.xml",paramName:"file",file:void 0}},{value:"xml-catalog",label:"Validate XML catalog",type:"item",description:"Validate an XML catalog (an XML instance file) against the OASIS schema specification for XML catalogs.",extensions:["xml"],icon:r.xml,group:"XML",route:C.validate_xml_catalog,file1:{fileType:"XML",icon:r.xml,description:"xml-catalog.xml",paramName:"file",file:void 0}}],k=I(E.filter(l=>l.type=="item")),H=I({XSD:k.filter(l=>l.group=="XSD"),XML:k.filter(l=>l.group=="XML")}),o=T(()=>k.find(l=>l.value==i.kind)),R=[{value:"json",label:"JSON",icon:r.json},{value:"csv",label:"CSV",icon:r.csv}],J=T(()=>{var l;if(i.mediaType!=null)return(l=R.find(e=>e.value==i.mediaType))==null?void 0:l.icon}),j=T(()=>i.mediaType!="json"?`?mediaType=${i.mediaType}`:""),g=I({tests:[],comment:"",errors:-1,info:-1,passed:-1,warnings:-1}),W=[{label:"Valid example",icon:r.success,onSelect:Z},{label:"Invalid example",icon:r.error,onSelect:K}];async function Z(){P(!0)}async function K(){P(!1)}async function P(l){var a;let e;switch((a=o.value)==null?void 0:a.value){case"ndr":return e=l?"CrashDriver-6.0.zip":"Crash Driver IEPD-invalid.zip",y("ndr/"+e,"file1");case"xsd":return e=l?"person.xsd":"person-invalid.xsd",y("xml/single/"+e,"file1");case"xml":return e=l?"person.xml":"person-invalid.xml",y("xml/single/"+e,"file1"),y("xml/single/person.xsd","file2");case"cmf":return e=l?"CrashDriver.cmf.xml":"CrashDriver-invalid.cmf.xml",y("xml/cmf/"+e,"file1");case"message-catalog":return e=l?"valid-5.0/iepd-catalog.xml":"invalid-5.0/iepd-catalog.xml",y("xml/message-catalog/"+e,"file1");case"xml-catalog":return e=l?"xml-catalog-valid.xml":"xml-catalog-invalid.xml",y("xml/xml-catalog/"+e,"file1")}}async function y(l,e){const c=await(await fetch("demo/validate/"+l)).blob(),M=l.split("/").pop()||"input.text",v=new File([c],M),f=new DataTransfer;f.items.add(v);const _=document.getElementById(e);_.files=f.files,i[e]=v}function Q(l){return`${l||"(pending)"} | ${G}`}const Y=T(()=>{var l,e,a,c;return((l=o.value)==null?void 0:l.file2)!=null?`-F ${(a=(e=o.value)==null?void 0:e.file2)==null?void 0:a.paramName}=@${(c=i.file2)==null?void 0:c.name}`:""}),ee=T(()=>{var l,e,a,c;return`curl -i -X POST -H "Content-Type: multipart/form-data" -F ${(e=(l=o.value)==null?void 0:l.file1)==null?void 0:e.paramName}=@${(a=i.file1)==null?void 0:a.name} ${Y.value} ${(c=o.value)==null?void 0:c.route}${j.value}`}),le=A(""),ie=A("");function ae(l){var a;const e=Se();return $(e,"kind",l.kind),$(e,"resultFormat",l.mediaType),$(e,"file1",l.file1),((a=o.value)==null?void 0:a.value)=="xml"&&$(e,"file2",l.file2),e}function ne(l){le.value="";const a=l.target.files;!a||a.length==0||(i.file1=a[0])}function te(l){ie.value="";const a=l.target.files;!a||a.length==0||(i.file2=a[0])}async function oe(){var c,M,v,f;if(!i.kind||!((c=o.value)!=null&&c.route)){console.warn("Cancelled request for missing fields");return}if(!i.file1){console.warn("Cancelled request for missing first file");return}const l=new FormData;if(o.value.value=="xml"){if(!i.file2){console.log("Cancelled request for missing second file");return}l.append("xml",i.file1),l.append("xsd",i.file2)}else l.append("file",i.file1);console.log("Sending validation request",i.kind,i.file1,i.file2);let e=Date.now();const a=await fetch(o.value.route+j.value,{body:l,method:"post"});if(t.time=Xe(e),a.ok){let _;if(t.filename=`${i.file1.name.split(".").slice(0,1)}-validation-${o.value.value}`,i.mediaType=="json"){t.filename+=".json";const d=await a.json(),V=JSON.stringify(d,null,2);_=new Blob([V],{type:"application/json"}),g.tests=d.tests,g.comment=d.comment,g.errors=d.errors,g.info=d.info,g.passed=d.passed,g.warnings=d.warnings}else if(i.mediaType=="csv"){t.filename+=".csv";const d=await a.text();_=new Blob([d],{type:"text/csv"})}else{console.warn("Media type not supported.  Could not save file.");return}we.saveAs(_,t.filename),t.category=i.mediaType=="json"?se():"info",t.title="",t.error=void 0,t.message=`Downloaded ${t.filename}.`,console.log("Request succeeded",t.filename)}else t.category="error",t.error=await a.json(),t.title=`ERROR ${(M=t.error)==null?void 0:M.status}: ${(v=t.error)==null?void 0:v.error}`,t.message=((f=t.error)==null?void 0:f.message.replaceAll(";",`

`))||"",console.log("Request failed");t.status="returned"}function se(){return g.errors?"error":g.warnings?"warning":"success"}return(l,e)=>{const a=ge,c=xe,M=Ie,v=ye,f=be,_=De,d=ve,V=Fe,re=Te,me=Ne,de=Ce,ce=Me;return N(),S(h,null,[s(M,{link:("links"in l?l.links:n(Le)).validate},{info:m(()=>[e[10]||(e[10]=u("p",null," Validate NIEM artifacts and check NDR conformance. ",-1)),e[11]||(e[11]=u("p",{class:"font-semibold"},"Notes:",-1)),u("ul",ke,[u("li",null,[e[3]||(e[3]=x(" Use the ")),s(a,{to:"/transform"},{default:m(()=>e[2]||(e[2]=[x("Transform")])),_:1}),e[4]||(e[4]=x(" feature to convert a CMF model to XSD to check NDR conformance. "))]),e[5]||(e[5]=u("li",null," JSON instance and schema validation is not yet available. ",-1)),e[6]||(e[6]=u("li",null," CSV results are download-only at this time and cannot be displayed. ",-1))]),(N(!0),S(h,null,B(Object.entries(n(H)),([F,L])=>(N(),S("div",null,[u("p",Ve,X(F)+" validation options:",1),u("ul",he,[(N(!0),S(h,null,B(L,b=>(N(),S("li",null,[u("span",Ee,X(b.label),1),e[8]||(e[8]=x(" - ")),u("span",null,X(b.description),1),b.note?(N(),S("span",Re,[e[7]||(e[7]=u("br",null,null,-1)),x(X(b.note),1)])):z("",!0)]))),256))]),e[9]||(e[9]=u("br",null,null,-1))]))),256))]),developer:m(()=>[s(c,{title:"POST request",code:n(ee)},null,8,["code"])]),_:1},8,["link"]),s(de,null,{default:m(()=>[s(me,{state:n(i),validate:ae,onSubmit:fe(oe,["prevent"]),enctype:"multipart/form-data"},{default:m(()=>{var F,L,b,U,q;return[s(f,{name:"kind",required:"",label:"1. Select validation kind",help:(F=n(o))==null?void 0:F.description},{default:m(()=>{var p;return[s(v,{modelValue:n(i).kind,"onUpdate:modelValue":e[0]||(e[0]=D=>n(i).kind=D),items:E,icon:(p=n(o))==null?void 0:p.icon,class:"w-64"},null,8,["modelValue","icon"])]}),_:1},8,["help"]),s(f,{name:"mediaType",required:"",label:"2. Select results format"},{default:m(()=>[s(v,{modelValue:n(i).mediaType,"onUpdate:modelValue":e[1]||(e[1]=p=>n(i).mediaType=p),items:R,icon:n(J),class:"w-64"},null,8,["modelValue","icon"])]),_:1}),s(f,{name:"file1",required:"",label:"3. Select a file to validate",help:Q((b=(L=n(o))==null?void 0:L.file1)==null?void 0:b.description)},{default:m(()=>[s(re,null,{default:m(()=>{var p,D;return[s(_,{onChange:ne,class:"w-[600px]",icon:(D=(p=n(o))==null?void 0:p.file1)==null?void 0:D.icon,id:"file1"},{trailing:m(()=>{var w,O;return[x("("+X((O=(w=n(o))==null?void 0:w.file1)==null?void 0:O.fileType)+")",1)]}),_:1},8,["icon"]),s(d,{color:"neutral",variant:"subtle",label:"Demo"}),s(V,{items:W,disabled:n(i).kind==null},{default:m(()=>[s(d,{color:"neutral",variant:"subtle",icon:("icons"in l?l.icons:n(r)).down},null,8,["icon"])]),_:1},8,["disabled"])]}),_:1})]),_:1},8,["help"]),(U=n(o))!=null&&U.file2?(N(),pe(f,{key:0,name:"file2",label:"4. Select supporting file for validation",help:((q=n(o))==null?void 0:q.file2.description)+" | "+("FILE_UPLOAD_WARNING"in l?l.FILE_UPLOAD_WARNING:n(G))},{default:m(()=>{var p,D;return[s(_,{onChange:te,class:"w-[600px]",icon:(D=(p=n(o))==null?void 0:p.file2)==null?void 0:D.icon,id:"file2"},{trailing:m(()=>{var w;return[x("("+X((w=n(o).file2)==null?void 0:w.fileType)+")",1)]}),_:1},8,["icon"])]}),_:1},8,["help"])):z("",!0),s(d,{type:"submit",ui:("ui"in l?l.ui:n(_e)).button_default},{default:m(()=>e[12]||(e[12]=[x("Validate")])),_:1},8,["ui"])]}),_:1},8,["state"])]),_:1}),s(ce,{results:n(t),validationResults:n(g)},null,8,["results","validationResults"])],64)}}}),Ze=$e(je,[["__scopeId","data-v-fa9f4e00"]]);export{Ze as default};
